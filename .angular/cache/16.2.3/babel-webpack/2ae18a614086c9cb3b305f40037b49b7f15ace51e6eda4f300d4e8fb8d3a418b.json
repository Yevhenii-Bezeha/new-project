{"ast":null,"code":"import _asyncToGenerator from \"/Users/ybezeha/WebstormProjects/new-project/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { request as defaultRequest } from \"@octokit/request\";\nimport { oauthRequest } from \"./utils\";\nfunction exchangeDeviceCode(_x) {\n  return _exchangeDeviceCode.apply(this, arguments);\n}\nfunction _exchangeDeviceCode() {\n  _exchangeDeviceCode = _asyncToGenerator(function* (options) {\n    const request = options.request || /* istanbul ignore next: we always pass a custom request in tests */\n    defaultRequest;\n    const response = yield oauthRequest(request, \"POST /login/oauth/access_token\", {\n      client_id: options.clientId,\n      device_code: options.code,\n      grant_type: \"urn:ietf:params:oauth:grant-type:device_code\"\n    });\n    const authentication = {\n      clientType: options.clientType,\n      clientId: options.clientId,\n      token: response.data.access_token,\n      scopes: response.data.scope.split(/\\s+/).filter(Boolean)\n    };\n    if (\"clientSecret\" in options) {\n      authentication.clientSecret = options.clientSecret;\n    }\n    if (options.clientType === \"github-app\") {\n      if (\"refresh_token\" in response.data) {\n        const apiTimeInMs = new Date(response.headers.date).getTime();\n        authentication.refreshToken = response.data.refresh_token, authentication.expiresAt = toTimestamp(apiTimeInMs, response.data.expires_in), authentication.refreshTokenExpiresAt = toTimestamp(apiTimeInMs, response.data.refresh_token_expires_in);\n      }\n      delete authentication.scopes;\n    }\n    return {\n      ...response,\n      authentication\n    };\n  });\n  return _exchangeDeviceCode.apply(this, arguments);\n}\nfunction toTimestamp(apiTimeInMs, expirationInSeconds) {\n  return new Date(apiTimeInMs + expirationInSeconds * 1e3).toISOString();\n}\nexport { exchangeDeviceCode };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}